#  Distance_Measurement 

## Overview

This project measures distance using an HC-SR04 ultrasonic sensor interfaced with an ATmega32 microcontroller running at 8MHz. The measured distance is displayed on a 4x16 LCD screen. The system is designed following a layered architecture model, using specific drivers for GPIO, ICU, LCD, and the ultrasonic sensor.

## Requirements

- **Microcontroller**: ATmega32 running at 8MHz
- **Ultrasonic Sensor**: HC-SR04
- **LCD Display**: 4x16 LCD
- **Development Environment**: Suitable IDE for AVR development (e.g., Atmel Studio)

## Hardware Connections

- **LCD Connections**:
  - RS → PB0
  - RW → Ground
  - E → PB1
  - Data Bus → PORTA (all pins)
  
- **Ultrasonic Sensor Connections**:
  - Trigger Pin → Configurable (defined in the code)
  - Echo Pin → Configurable (defined in the code)

## Software Components

### GPIO Driver

Use the GPIO driver provided in the course for basic input/output operations.

### ICU (Input Capture Unit) Driver

Use the ICU driver provided in the course with the following configurations:
- Frequency: F_CPU/8
- Detect the rising edge as the first edge

### LCD Driver

Use the LCD driver provided in the course with the following configurations:
- Mode: 8-bit data mode
- Pin connections as specified above

### Ultrasonic Sensor Driver

Implement the following functions in the ultrasonic driver:

#### 1. `void Ultrasonic_init(void)`

- Initialize the ICU driver.
- Set up the ICU callback function.
- Set the direction for the trigger pin as output using the GPIO driver.

#### 2. `void Ultrasonic_Trigger(void)`

- Send the trigger pulse to the ultrasonic sensor.

#### 3. `uint16 Ultrasonic_readDistance(void)`

- Send the trigger pulse using `Ultrasonic_Trigger`.
- Start measurements using the ICU.
- Return the measured distance in centimeters.

#### 4. `void Ultrasonic_edgeProcessing(void)`

- Callback function called by the ICU driver.
- Calculate the high time (pulse time) generated by the ultrasonic sensor.

## Implementation Steps

1. **Initialize the System Clock**: Configure the ATmega32 microcontroller to operate at 8MHz.
2. **Initialize the LCD**: Use the LCD driver to initialize the 4x16 LCD with the specified pin connections.
3. **Initialize the Ultrasonic Sensor**: Call `Ultrasonic_init` to set up the ICU and trigger pin.
4. **Measure Distance**:
   - Trigger the sensor using `Ultrasonic_Trigger`.
   - Read the distance using `Ultrasonic_readDistance`.
5. **Display Distance on LCD**: Use the LCD driver to display the measured distance.

## Example Code Snippets

### Initialization

```c
void Ultrasonic_init(void) {
    ICU_init();
    ICU_setCallBack(Ultrasonic_edgeProcessing);
    GPIO_setupPinDirection(TRIGGER_PORT, TRIGGER_PIN, PIN_OUTPUT);
}
